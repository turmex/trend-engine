{% from "helpers.j2" import day_label, tag_pill %}
{# ════ CONTENT PLAYBOOK ════ #}
{% if strategy %}

{# ── Playbook Header ── #}
<div style="background:#fefce8;padding:20px 24px;">
    <h2 style="font-size:20px;color:#92400e;margin:0;">Your Content Playbook This Week</h2>
    <p style="font-size:13px;color:#78716c;margin:4px 0 0;">AI-generated strategy based on the data above. Adapt to your voice.</p>
</div>

{# ══════════════════════════════════════════════════════════════ #}
{# MONDAY: VIDEO                                                  #}
{# ══════════════════════════════════════════════════════════════ #}
{% if strategy.monday %}
<div style="padding:24px;">
    <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px;">
        {{ day_label("MONDAY", "#dc2626") }}
        <h3 style="margin:0;font-size:17px;">Video -- The Hook</h3><span style="background:#fef2f2;color:#991b1b;font-size:11px;font-weight:600;padding:2px 8px;border-radius:10px;margin-left:8px;">~45 min</span>
    </div>

    {% if strategy.monday.video_title %}
    <div style="background:#fef2f2;border:1px solid #fecaca;border-radius:8px;padding:16px;margin-bottom:12px;">
        <div style="font-weight:700;color:#991b1b;font-size:13px;">VIDEO TITLE</div>
        <div style="font-size:15px;margin-top:4px;">{{ strategy.monday.video_title }}</div>
    </div>
    {% endif %}

    {% if strategy.monday.hook %}
    <div style="font-weight:700;font-size:13px;color:#475569;margin-bottom:4px;">HOOK (first 10 seconds):</div>
    <div style="background:#f8fafc;border-left:3px solid #dc2626;padding:10px 14px;font-size:14px;font-style:italic;margin-bottom:12px;">"{{ strategy.monday.hook }}"</div>
    {% endif %}

    {% if strategy.monday.talking_points %}
    <div style="font-weight:700;font-size:13px;color:#475569;margin-bottom:4px;">TALKING POINTS:</div>
    <ul style="margin:0 0 12px;padding-left:20px;font-size:13px;line-height:1.6;">
        {% for point in strategy.monday.talking_points %}
        <li style="margin-bottom:6px;">{{ point }}</li>
        {% endfor %}
    </ul>
    {% endif %}

    {% if strategy.monday.exercises %}
    <div style="font-weight:700;font-size:13px;color:#475569;margin-bottom:4px;">EXERCISE RX:</div>
    <ol style="margin:0 0 12px;padding-left:20px;font-size:13px;line-height:1.6;">
        {% for ex in strategy.monday.exercises %}
        <li style="margin-bottom:4px;">{{ ex }}</li>
        {% endfor %}
    </ol>
    {% endif %}

    {# ── Clinical exercise details (sets/reps/contraindications) ── #}
    {% if strategy.monday.exercise_details %}
    <div style="background:#fff7ed;border:1px solid #fed7aa;border-radius:8px;padding:14px;margin-bottom:12px;">
        <div style="font-weight:700;font-size:13px;color:#9a3412;margin-bottom:8px;">CLINICAL DETAIL:</div>
        {% for detail in strategy.monday.exercise_details %}
        <div style="margin-bottom:8px;{% if not loop.last %}border-bottom:1px solid #fed7aa;padding-bottom:8px;{% endif %}">
            <div style="font-weight:600;font-size:13px;color:#1e293b;">{{ detail.name }}</div>
            {% if detail.sets %}<div style="font-size:12px;color:#475569;margin-top:2px;">Sets/Reps: {{ detail.sets }}</div>{% endif %}
            {% if detail.progression %}<div style="font-size:12px;color:#16a34a;margin-top:2px;">Progression: {{ detail.progression }}</div>{% endif %}
            {% if detail.regression %}<div style="font-size:12px;color:#2563eb;margin-top:2px;">Regression: {{ detail.regression }}</div>{% endif %}
            {% if detail.contraindication %}<div style="font-size:12px;color:#dc2626;margin-top:2px;font-weight:600;">Contraindication: {{ detail.contraindication }}</div>{% endif %}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if strategy.monday.cta %}
    <div style="font-weight:700;font-size:13px;color:#475569;margin-bottom:4px;">END CTA:</div>
    <div style="font-size:13px;margin-bottom:16px;">"{{ strategy.monday.cta }}"</div>
    {% endif %}

    {# ── Thumbnail guidance ── #}
    {% if strategy.monday.thumbnail %}
    <div style="background:#fef3c7;border:1px solid #fde68a;border-radius:8px;padding:14px;margin-bottom:12px;">
        <div style="font-weight:700;font-size:13px;color:#92400e;margin-bottom:6px;">THUMBNAIL GUIDE:</div>
        {% if strategy.monday.thumbnail.text_overlay %}
        <div style="font-size:13px;margin-bottom:4px;"><strong>Text overlay:</strong> {{ strategy.monday.thumbnail.text_overlay }}</div>
        {% endif %}
        {% if strategy.monday.thumbnail.pose_suggestion %}
        <div style="font-size:13px;margin-bottom:4px;"><strong>Pose:</strong> {{ strategy.monday.thumbnail.pose_suggestion }}</div>
        {% endif %}
        {% if strategy.monday.thumbnail.color_scheme %}
        <div style="font-size:13px;"><strong>Colors:</strong> {{ strategy.monday.thumbnail.color_scheme }}</div>
        {% endif %}
    </div>
    {% endif %}

    {# ── Viewer self-assessment ── #}
    {% if strategy.monday.viewer_assessment %}
    <div style="background:#ecfdf5;border:1px solid #a7f3d0;border-radius:8px;padding:14px;margin-bottom:12px;">
        <div style="font-weight:700;font-size:13px;color:#065f46;margin-bottom:4px;">VIEWER SELF-CHECK:</div>
        <div style="font-size:13px;color:#374151;line-height:1.5;">{{ strategy.monday.viewer_assessment }}</div>
        <div style="font-size:11px;color:#6b7280;margin-top:6px;font-style:italic;">Have your audience try this before starting the exercises. Creates engagement AND identifies who needs consultation.</div>
    </div>
    {% endif %}

    {# ── Platform-by-platform posting guide ── #}
    {% if strategy.monday.platforms %}
    <div style="background:#f8fafc;border-radius:8px;padding:14px;font-size:12px;">
        <div style="font-weight:700;color:#475569;margin-bottom:6px;">PLATFORM-BY-PLATFORM POSTING GUIDE:</div>

        {% if strategy.monday.platforms.youtube %}
        <div style="margin-bottom:10px;">
            <div style="font-weight:600;color:#dc2626;">&#9654; YouTube</div>
            <div style="color:#4b5563;margin-top:2px;white-space:pre-wrap;">{{ strategy.monday.platforms.youtube.description | default('') }}</div>
            {% if strategy.monday.platforms.youtube.tags %}
            <div style="margin-top:4px;">Tags: {% for t in strategy.monday.platforms.youtube.tags %}{{ tag_pill(t) }} {% endfor %}</div>
            {% endif %}
        </div>
        {% endif %}

        {% if strategy.monday.platforms.linkedin %}
        <div style="margin-bottom:10px;">
            <div style="font-weight:600;color:#0077b5;">&#9654; LinkedIn (native video upload)</div>
            <div style="color:#4b5563;margin-top:2px;white-space:pre-wrap;">{{ strategy.monday.platforms.linkedin }}</div>
        </div>
        {% endif %}

        {% if strategy.monday.platforms.instagram %}
        <div style="margin-bottom:10px;">
            <div style="font-weight:600;color:#E1306C;">&#9654; Instagram Reels (60-90 sec cut)</div>
            <div style="color:#4b5563;margin-top:2px;white-space:pre-wrap;">{{ strategy.monday.platforms.instagram }}</div>
        </div>
        {% endif %}

        {% if strategy.monday.platforms.tiktok %}
        <div>
            <div style="font-weight:600;color:#000;">&#9654; TikTok (same as IG Reel)</div>
            <div style="color:#4b5563;margin-top:2px;white-space:pre-wrap;">{{ strategy.monday.platforms.tiktok }}</div>
        </div>
        {% endif %}
    </div>
    {% endif %}
</div>

<hr style="border:none;border-top:1px solid #f0f0f0;margin:0;">
{% endif %}

{# ══════════════════════════════════════════════════════════════ #}
{# WEDNESDAY: LINKEDIN POST + BLOG                               #}
{# ══════════════════════════════════════════════════════════════ #}
{% if strategy.wednesday %}
<div style="padding:24px;">
    <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px;">
        {{ day_label("WEDNESDAY", "#2563eb") }}
        <h3 style="margin:0;font-size:17px;">LinkedIn Post + Blog Article -- The Depth</h3><span style="background:#fef2f2;color:#991b1b;font-size:11px;font-weight:600;padding:2px 8px;border-radius:10px;margin-left:8px;">~45 min</span>
    </div>

    {% if strategy.wednesday.linkedin_post %}
    <div style="font-weight:700;font-size:13px;color:#475569;margin-bottom:4px;">LINKEDIN POST DRAFT:</div>
    <div style="background:#f8fafc;border:1px solid #e2e8f0;border-radius:8px;padding:16px;font-size:13px;line-height:1.7;white-space:pre-wrap;margin-bottom:16px;">{{ strategy.wednesday.linkedin_post }}</div>
    {% endif %}

    {% if strategy.wednesday.blog_title or strategy.wednesday.seo_target or strategy.wednesday.cross_post %}
    <div style="background:#eff6ff;border:1px solid #bfdbfe;border-radius:8px;padding:14px;font-size:12px;">
        <div style="font-weight:700;color:#1e40af;margin-bottom:6px;">BLOG / SEO NOTES:</div>
        {% if strategy.wednesday.blog_title %}
        <div><strong>Blog title:</strong> {{ strategy.wednesday.blog_title }}</div>
        {% endif %}
        {% if strategy.wednesday.seo_target %}
        <div style="margin-top:4px;"><strong>SEO:</strong> {{ strategy.wednesday.seo_target }}</div>
        {% endif %}
        {% if strategy.wednesday.medium_subtitle %}
        <div style="margin-top:4px;"><strong>Medium subtitle:</strong> {{ strategy.wednesday.medium_subtitle }}</div>
        {% endif %}
        {% if strategy.wednesday.cross_post %}
        <div style="margin-top:8px;"><strong>Cross-post to:</strong> {{ strategy.wednesday.cross_post }}</div>
        {% endif %}
    </div>
    {% endif %}

    {% if strategy.wednesday.study_citation %}
    <div style="background:#f5f3ff;border:1px solid #ddd6fe;border-radius:8px;padding:14px;margin-top:12px;">
        <div style="font-weight:700;font-size:13px;color:#5b21b6;margin-bottom:4px;">CITE THIS STUDY:</div>
        <div style="font-size:13px;color:#374151;line-height:1.5;">{{ strategy.wednesday.study_citation }}</div>
    </div>
    {% endif %}
</div>

<hr style="border:none;border-top:1px solid #f0f0f0;margin:0;">
{% endif %}

{# ══════════════════════════════════════════════════════════════ #}
{# FRIDAY: SOCIAL CARD + RESULTS ASK                             #}
{# ══════════════════════════════════════════════════════════════ #}
{% if strategy.friday %}
<div style="padding:24px;">
    <div style="display:flex;align-items:center;gap:8px;margin-bottom:12px;">
        {{ day_label("FRIDAY", "#16a34a") }}
        <h3 style="margin:0;font-size:17px;">Social Card + Results Ask -- The Close</h3><span style="background:#fef2f2;color:#991b1b;font-size:11px;font-weight:600;padding:2px 8px;border-radius:10px;margin-left:8px;">~10 min</span>
    </div>

    {% if strategy.friday.stat_line or strategy.friday.tip %}
    <div style="background:#f0fdf4;border:1px solid #bbf7d0;border-radius:8px;padding:16px;margin-bottom:12px;">
        {% if strategy.friday.stat_line %}
        <div style="font-size:20px;font-weight:700;color:#15803d;margin-bottom:4px;">{{ strategy.friday.stat_line }}</div>
        {% endif %}
        {% if strategy.friday.tip %}
        <div style="font-size:14px;color:#374151;">{{ strategy.friday.tip }}</div>
        {% endif %}
    </div>
    {% endif %}

    {% if strategy.friday.engagement_ask %}
    <div style="font-weight:700;font-size:13px;color:#475569;margin-bottom:4px;">ENGAGEMENT ASK:</div>
    <div style="background:#fef9c3;border-left:3px solid #eab308;padding:10px 14px;font-size:14px;margin-bottom:12px;">"{{ strategy.friday.engagement_ask }}"</div>
    {% endif %}

    {% if strategy.friday.platforms %}
    <div style="background:#f8fafc;border-radius:8px;padding:14px;font-size:12px;">
        <div style="font-weight:700;color:#475569;margin-bottom:6px;">PLATFORM POSTING:</div>
        {% if strategy.friday.platforms.linkedin %}
        <div style="margin-bottom:6px;"><strong>LinkedIn:</strong> {{ strategy.friday.platforms.linkedin }}</div>
        {% endif %}
        {% if strategy.friday.platforms.pinterest %}
        <div style="margin-bottom:6px;"><strong>Pinterest:</strong> {{ strategy.friday.platforms.pinterest }}</div>
        {% endif %}
        {% if strategy.friday.platforms.also_post %}
        <div><strong>Also post to:</strong> {{ strategy.friday.platforms.also_post }}</div>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endif %}

{% endif %}
