{% from "helpers.j2" import new_badge %}
{# ════ REDDIT ════ #}
{% if analysis and analysis.reddit and analysis.reddit.posts %}
<div style="padding:24px;">
    <h2 style="font-size:17px;margin:0 0 4px;">Reddit -- Top Posts This Week</h2>
    <p style="font-size:12px;color:#6b7280;margin:0 0 12px;">
        {% if analysis.reddit.subreddit_count is defined %}
        Across {{ analysis.reddit.subreddit_count }} monitored subreddits
        {% else %}
        Top engagement from monitored subreddits
        {% endif %}
    </p>
    <table style="width:100%;border-collapse:collapse;font-size:13px;">
        <tbody>
        {% for post in analysis.reddit.posts %}
        <tr><td style="padding:8px 10px;border-bottom:1px solid #f0f0f0;">
            {% if post.is_new %}{{ new_badge() }}{% endif %}<a href="{{ post.url | default('#') }}" style="color:#2563eb;text-decoration:none;font-weight:500;">{{ post.title }}</a>
            <div style="font-size:11px;color:#9ca3af;">{{ post.subreddit | default('') }}{% if post.score is not none %} &middot; &#9650;{{ post.score }}{% endif %}{% if post.num_comments is not none %} &middot; {{ post.num_comments }} comments{% endif %}</div>
        </td></tr>
        {% endfor %}
        </tbody>
    </table>
</div>
{% endif %}
